{% extends "wagtailadmin/base.html" %}
{% load static wagtailimages_tags wagtailadmin_tags %}

{% block branding_logo %}
    {% if active_client and active_client.logo %}
        {% image active_client.logo width-80 %}
        <!-- <h5>{{ active_plan.name }}</h5> -->
    {% else %}
        <img src="{% static 'images/kausal-avatar-dark-green.svg' %}" alt="Kausal Logo" width="80" />
    {% endif %}
{% endblock %}

{% block js %}
    {{ block.super }}
    {% if sentry_dsn %}
    <script>
        if (KausalSentry !== undefined) {
            KausalSentry.initSentry({
                dsn: '{{ sentry_dsn }}',
                user: '{{ request.user.email }}',
                plan: '{{ active_plan.identifier }}',
                environment: '{{ deployment_type }}',
                client: '{{ active_client.name|default:"none"|escape }}'
            });
        }
    </script>
    {% endif %}
    {# Workaround for being able to navigate to the action button's dropdown menu with the keyboard #}
    <script>
      $(document).ready(function () {
        const dropdownButton = document.querySelector('form footer .dropdown-toggle');
        if (dropdownButton != null) {
          dropdownButton.tabIndex = 0;
          dropdownButton.addEventListener('keydown', (e) => (e.code === "Space" || e.code === "Enter") && dropdownButton.click());
        }
      });
    </script>
{% endblock %}
